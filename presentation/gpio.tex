\begin{frame}
    \centering
    \begin{tikzpicture}
      \node at (0,0) {\includegraphics[width=3cm]{img/raspi.jpg}};
      \path[snake=expanding waves,segment length=2mm,segment angle=30,draw,thick,color=blue] (-1.3,0.85) -- +(-2,0);
      %\draw[ultra thick] plot [smooth,tension=1.5] coordinates{(-1,-1) (-2.2, -1.6) (-4, -1.2) (-4.5, -3)};
	  \draw[ultra thick] (-1,-1) .. controls(-1.5,-3) and (-4,0) .. (-4.5,-3);
      \node at (-4.5, -3) {\includegraphics[width=5cm]{img/Musical_keyboard.png}};
    \end{tikzpicture}
\end{frame}

\begin{frame}
	\frametitle{GPIO Keyboard with Note Velocity}
	\centering
	\begin{tikzpicture}
		\path[use as bounding box] (1,-6) rectangle (-8,1);
		\draw [rotate=0] (0,0) -- (0,0.5) -- (-7,0.5) to[out=180,in=90] (-7,0.3) -- (-7,-0.5) -- (-4,-0.5) -- (-4,0) -- cycle;
		\fill (-1,-0.35) rectangle +(0.4,0.2) +(0.1,0) rectangle +(0.3,0.35);
		\draw (-1,-0.25) -- +(-0.1,-0.1);
		\draw (-0.6,-0.25) -- +(0.1,-0.1);
		
		\fill (-6.5,-1.4) rectangle +(0.4,0.2) +(0.1,0) rectangle +(0.3,0.35);
		\draw (-6.5,-1.3) -- +(-0.1,-0.1);
		\draw (-6.1,-1.3) -- +(0.1,-0.1);
		
		\draw (-0.8,-2) -- +(0,-1.5);
		\draw (-6.3,-2) -- +(0,-1.5);
		
	\end{tikzpicture}
\end{frame}
\begin{frame}
	\frametitle{GPIO Keyboard with Note Velocity}
	\centering
	\begin{tikzpicture}
		\path[use as bounding box] (1,-6) rectangle (-8,1);
		\draw [rotate=1] (0,0) -- (0,0.5) -- (-7,0.5) to[out=180,in=90] (-7,0.3) -- (-7,-0.5) -- (-4,-0.5) -- (-4,0) -- cycle;
		\fill (-1,-0.35) rectangle +(0.4,0.2) +(0.1,0) rectangle +(0.3,0.33);
		\draw (-1,-0.25) -- +(-0.1,-0.1);
		\draw (-0.6,-0.25) -- +(0.1,-0.1);
		
		\fill (-6.5,-1.4) rectangle +(0.4,0.2) +(0.1,0) rectangle +(0.3,0.35);
		\draw (-6.5,-1.3) -- +(-0.1,-0.1);
		\draw (-6.1,-1.3) -- +(0.1,-0.1);
		
		\draw (-0.8,-2) -- +(0,-1.5);
		\draw (-6.3,-2) -- +(0,-1.5);
		
		\draw[line width=1em] (-0.8,-2.3) -- +(0,0.3);
		
	\end{tikzpicture}
\end{frame}
\begin{frame}
	\frametitle{GPIO Keyboard with Note Velocity}
	\centering
	\begin{tikzpicture}
		\path[use as bounding box] (1,-6) rectangle (-8,1);
		\draw [rotate=5] (0,0) -- (0,0.5) -- (-7,0.5) to[out=180,in=90] (-7,0.3) -- (-7,-0.5) -- (-4,-0.5) -- (-4,0) -- cycle;
		\fill (-1,-0.35) rectangle +(0.4,0.2) +(0.1,0) rectangle +(0.3,0.28);
		\draw (-1,-0.25) -- +(-0.1,-0.1);
		\draw (-0.6,-0.25) -- +(0.1,-0.1);
		
		\fill (-6.5,-1.4) rectangle +(0.4,0.2) +(0.1,0) rectangle +(0.3,0.35);
		\draw (-6.5,-1.3) -- +(-0.1,-0.1);
		\draw (-6.1,-1.3) -- +(0.1,-0.1);
		
		\draw (-0.8,-2) -- +(0,-1.5);
		\draw (-6.3,-2) -- +(0,-1.5);
		\draw[line width=1em] (-6.3,-2.3) -- +(0,0.3);
		\draw[line width=1em] (-0.8,-3.3) -- +(0,1.3);
		
		\draw[dashed] (0,-2.3) -- +(-7,0);
		\draw[dashed] (0,-3.3) -- +(-7,0);
		
		\pause
		
		\draw[|<->|] (0,-2.3) -- node[right]{$\Delta t$} +(0,-1);
		
		\node at (-3.5,-4.5) {$\text{midi\_velocity}=\frac{\text{idle\_stroke}}{\text{Time B - Time A}}$};
	\end{tikzpicture}
\end{frame}
		
		%\draw [rotate=5] (0,0.5) -- (0.1,0.7) -- (-5,0.7) -- +(0.05,0.1) -- (-6.85,0.8) to[out=180,in=90] (-6.85,0.6);
		%\node at (-4,2) {\includegraphics[width=4cm]{img/key1.pdf}};
		%\node[align=left ,text width=4cm] at (1,2) { Two buttons connected \\ to GPIO ports};
		%\node at (-4,0) {\includegraphics[width=4cm ]{img/key2.pdf}};
		%\node[align=left ,text width=4cm] at (1,0) { Interrupt Time A};
		%\node at (-4,-2) {\includegraphics[width=4cm]{img/key3.pdf}};
		%\node[align=left ,text width=4cm] at (1,-2) { Interrupt Time B};
		%\node[align=left ,text width=6cm] at (-1,-3.5) {  $midi\_velocity=\frac{idle\_stroke}{Time B - Time A}$};

\begin{frame}
  \frametitle{CMIDID Kernel Module}
  \centering
  \begin{tikzpicture}
    \node at (0, 0) {\includegraphics[width=4cm]{img/tux-on-eighth-note.jpg}};
    \node[rotate=90] at (-5, 0) {\includegraphics[width=4cm]{img/Musical_keyboard.png}};
    \node[align=center, text width=4cm] at (-3, 2.4) {GPIO Interrupts};
    \draw[ultra thick, ->] (-4, 1.5) -- (-2, 1.5);
    \draw[ultra thick, ->] (-4, .75) -- (-2, .75);
    \draw[ultra thick, ->] (-4, 0) -- (-2, 0);
    \draw[ultra thick, ->] (-4, -.75) -- (-2, -.75);
    \draw[ultra thick, ->] (-4, -1.5) -- (-2, -1.5);
    \node[align=center, text width=4cm] at (0,-2.2) {CMIDID Module};
    \draw[ultra thick, ->] (2, 0) -- (2.5, 0);
    \node[text width=2cm, draw] at (4, 0) {ALSA\\Sequencer\\Interface};
    \node[text width=4cm, align=center, rotate=270] at (2.2, -0.2) {MIDI\qquad Events};
  \end{tikzpicture}
\end{frame}

\begin{frame}
	\frametitle{ALSA}
	\centering
  	\begin{tikzpicture}
		\node at(0,0) {\includegraphics[width=6cm]{img/alsa.png}};
		\pause
		\draw[ultra thick, color= pink] (2.9, -2.1) rectangle (0.9,-0.7);
	\end{tikzpicture}
\end{frame}

\begin{frame}[fragile]
	\frametitle{ALSA sequencer connection manager}
Input devices (\texttt{aconnect -i}):
  	\begin{lstlisting}
client 20: 'cmidid-client' [type=kernel] 
    0 'cmididpinfo    
	\end{lstlisting}
Output devices (\texttt{aconnect -o}):
  	\begin{lstlisting}
client 128: 'FLUID Synth (2274)' [type=user]
    0 'Synth input port (2274:0)'
\end{lstlisting}
$ $
\\
Connect both ports with \texttt{aconnect 20:0 128:00}



\end{frame}

\begin{frame}
	\frametitle{Why Kernel Module?}
\begin{tikzpicture}
	\node at (-6cm,0) {\includegraphics[width=5cm]{img/cheetah.png}};
	\node[text width=7cm] at(-2,-3) {
	\begin{itemize} 
		\item precise timers (1 ns resolution) 
		\item usage of interrupts $\Rightarrow$ short delay
		\item relativley small overhead 
	\end{itemize}};
\end{tikzpicture}
\end{frame} 
